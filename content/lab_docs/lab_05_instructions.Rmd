---
title: 'Instructions for Lab #5: Feedbacks'
author: Jonathan Gilligan
lab_number: 5
lab_date: '2021-02-22'
pubdate: '2020-12-31'
date: '2021-02-22'
pdf_url: /files/lab_docs/lab_05/lab_05_instructions.pdf
slug: lab_05_instructions
output:
  blogdown::html_page:
    md_extensions: +tex_math_single_backslash+compact_definition_lists
    toc: yes
---
```{r setup, include=FALSE}
knitr::knit_hooks$set(inline = function(x) { knitr:::format_sci(x, 'md')})
knitr::opts_chunk$set(echo = TRUE, include = TRUE, cache = FALSE)

# This section loads necessary R libraries and sources scripts that define 
# useful functions format_md.
# 
data_dir = "_data"
script_dir = "_scripts"

library(pacman)
p_load(tidyverse, jsonlite, httr, magrittr, scales, xml2)

theme_set(theme_bw(base_size = 10))

source(file.path(script_dir, "utils.R"), chdir = T)
source(file.path(script_dir, "format_md.R"), chdir = T)
source(file.path(script_dir, "modtran.R"), chdir = T)
source(file.path(script_dir, "rrtm.R"), chdir = T)
```
# Exercises with clouds.

# Exercises

These are the exercises you will work for the lab this week.

### General Instructions

For this week's lab, when you write up the answers, I would
like you to think about integrating your R code chunks with your text.

For instance, you can describe what you're going to do to answer the question, 
and then for each step, after you describe what you're going to do in that
step, you can include an R code chunk to do what you just described, and then
the subsequent text can either discuss the results of what you just did
or describe what the next step of the analysis will do.

This way, your answer can have several small chunks of R code that build on
each other and follow the flow of your text.

## Chapter 7 Exercises

### Exercise 7.2: Clouds and Infrared.

**Note:** this exercise only considers the effect of clouds on longwave
radiation and ignores the effect of clouds on albedo, which is also important.

a) Run the MODTRAN model with present-day CO~2~ (400 ppm) and a tropical atmosphere. 
   Plot the outgoing infrared spectrum. 
   
    Run MODTRAN four times: first with no clouds, and then with three different
    kinds of clouds: standard cirrus, altostratus, and stratus. These correspond
    to high, medium, and low-altitude clouds.

    Describe the important differences between the spectra for the four cases.
    Describe the differences in the intensity of outgoing infrared radiation
    $I_{\text{out}}$ for the four cases.

    How do the four spectra compare for the 700 cm^-1^ band (where CO~2~ absorbs
    strongly) and the 900 cm^-1^ band (in the atmospheric window)?

    Which kind of cloud has the greatest impact on outgoing infrared light?
    Why?

b) Now set `atmosphere` to `"midlatitude winter"`, set `clouds` to `"none"`,
   and set the sensor altitude to 0 km (`altitude_km = 0`) and make the sensor 
   look up (`looking = "up"`). 
   This means your sensor is on the ground looking up at the longwave radiation 
   coming down from the atmosphere to the ground instead of looking down from 
   the top of the atmosphere at the longwave radiation going out to space.
   
    Run MODTRAN first with `h2o_scale = 1` (the default), and then with
    `h2o_scale = 0` (no water vapor).
    
    Plot the two spectra and compare them. Discuss why you see what you see:
    
    * For the atmosphere with no water vapor, compare the parts of the 
      spectrum corresponding to the strong CO~2~ absorption 
      (roughly 600--750 cm^-1^) and the infrared window 
      (roughly 800--1200 cm^-1^). 
      
        * Which corresponds to higher emission temperatures and which to lower temperatures? 
        * Why do you think this is?
    
    * For the atmosphere with normal water vapor (`h2o_scale = 1`), how does 
      water vapor change the spectrum you see from the ground?
      
        * Does it make the longwave radiation brighter (warmer) or dimmer
          (cooler)?
        * Why do you think this is?
    
c) Keeping the same settings for `atmosphere = "midlatitude winter"`,
   `altitude_km = 0`, and `looking="up"`, set `h2o_scale=1`
   and run MODTRAN first with no clouds, then with three kinds of clouds:
   standard cirrus, altostratus, and stratus (`clouds="none"`, 
   `clouds="standard cirrus"`, `clouds="altostratus"`, and `clouds="stratus"`).
   
    When we're looking up at the clouds, the base (bottom) of the clouds form
    a layer that is opaque to longwave radiation, with an emissivity of 1
    (i.e., a perfect black body).
    
    Cirrus clouds are very high (around 10 km above sea level), 
    altostratus clouds are at a medium height (with a base around 2.4 km), 
    and stratus clouds are very low (with a base around 0.33 km).

    For each run examine  
    $I_{\text{down}}$. (Remember that the variable `i_out` in the MODTRAN
    output measures the intensity of longwave radiation reaching the sensor.
    In this exercise, the sensor is on the ground looking up, so `i_out` 
    measures the downward radiation reaching the ground.)

    Describe how $I_{\text{down}}$ compares for the four conditions.
    
        * Do the clouds have a heating or cooling effect?
        * Which clouds have the greatest effect?
        * What does this suggest about how clouds affect the ground temperature?
        
    As you do this exercise, think about a winter night with clear skies 
    versus a winter night with cloudy skies.
    
d) Plot the longwave radiation spectra for the four MODTRAN runs from part (c).
   Which parts of the spectrum do the different clouds affect the most?
   (Compare the infrared window to the parts of the spectra where CO~2~ 
   absorbs.)
   
    * Look at two parts of the spectrum: the infrared window 
      (roughly 800--1200 cm^-1^) and the region where CO~2~ absorbs strongly 
      (roughly 600--750 cm^-1^).
   
      Why do you suppose the high, medium, and low clouds affect the two
      different spectral regions the way they do?
      
    * In which part of the spectrum do the clouds affect the downward longwave
      radiation the most?

### Exercise 7.3: Clouds and Visible Light.

For this exercise, you will use the RRTM model to examine climate sensitivity
and the water vapor feedback in a radiative-convective atmosphere.

a) First, run the RRTM model with its default parameters (400 ppm CO~2~) and 
   note the surface temperature (`T_surface`).
   
    Then run it again with doubled CO~2~ concentration (`co2 = 800`).
    Adjust the surface temperature to bring the heat imbalance `Q` to zero
    (it may be easier to do this with the interactive model at 
    <http://climatemodels.uchicago.edu/rrtm/> and then paste the new surface
    temperature into your R code).
    
    The change in surface temperature between the 400 ppm CO~2~ and 
    800 ppm CO~2~ ($\Delta T_{2 \times \text{CO}_2}$) runs is the 
    **climate sensitivity**. What is it?

b) Now run the RRTM model again, for 400 and 800 ppm CO~2~, but this time 
   setting `relative_humidity = 0` (this turns off the water vapor feedback).
   At each concentration of CO~2~, adjust `T_surface` to bring the heat into
   balance (so the output has `Q` equal to zero). Now what is the climate 
   sensitivity $\Delta T_{2 \times \text{CO}_2}$?
   
c) Compare the climate sensitivity ($\Delta T_{2 \times \text{CO}_2}$) in 
   part (a) (with water-vapor feedback) and part (b) (without water-vapor 
   feedback).
   The amplification factor for the water-vapor feedback is the ratio of the 
   climate sensitivity with water-vapor feedback to the sensitivity without the 
   feedback. 
   What is it?
